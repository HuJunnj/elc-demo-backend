var e=(e,t,n)=>new Promise(((s,r)=>{var o=e=>{try{l(n.next(e))}catch(t){r(t)}},i=e=>{try{l(n.throw(e))}catch(t){r(t)}},l=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,i);l((n=n.apply(e,t)).next())}));import{f as t,g as n,j as s,k as r,V as o,T as i,B as l,I as a}from"./vendors.ab65bca1.js";const c="https://your-api.example.com",d=t.getEnv()===t.ENV_TYPE.WEB,u=n.create({baseURL:c,timeout:1e4,headers:{"Content-Type":"application/json"}});function p(t,n="GET",s){return e(this,null,(function*(){try{const e=yield u({url:t,method:n,data:s,params:"GET"===n?s:void 0});return e.data}catch(e){throw new Error(`[Axios] ${e.message}`)}}))}function h(n,s="GET",r){return e(this,null,(function*(){try{const e=yield t.request({url:`${c}${n}`,method:s,data:r,header:{"Content-Type":"application/json"}});return e.data}catch(e){throw new Error(`[Taro] Request failed: ${e}`)}}))}const y={get:(e,t)=>d?p(e,"GET",t):h(e,"GET",t),post:(e,t)=>d?p(e,"POST",t):h(e,"POST",t)},m="http://localhost:8080",x=()=>e(void 0,null,(function*(){const e=yield y.get(`${m}/products`);return e})),f=(t,n)=>e(void 0,null,(function*(){const e=yield y.post(`${m}/orders`,{productId:t,quantity:n});return e})),j=()=>{const[t,n]=s.useState([]),[c,d]=s.useState(null),[u,p]=s.useState("1"),[h,y]=s.useState(null),[m,j]=s.useState(null);s.useEffect((()=>{x().then(n).catch((e=>{console.log(e),j("\u52a0\u8f7d\u5546\u54c1\u5931\u8d25")}))}),[]);const g=()=>e(void 0,null,(function*(){if(!c)return void j("\u8bf7\u9009\u62e9\u5546\u54c1");const e=parseInt(u,10);if(isNaN(e)||e<=0)j("\u8bf7\u8f93\u5165\u6709\u6548\u8d2d\u4e70\u6570\u91cf");else{j(null);try{const t=yield f(c,e);y(t)}catch(t){j(t.message||"\u4e0b\u5355\u5931\u8d25"),y(null)}}}));return r.jsxs(o,{style:{padding:20},children:[r.jsx(i,{style:{fontSize:24,fontWeight:"bold"},children:"\u5546\u54c1\u5217\u8868"}),t.map((e=>r.jsxs(o,{style:{marginTop:3,borderBottom:"1px solid #eee",paddingBottom:3},children:[r.jsxs(i,{style:{fontSize:20},children:[e.name," - \uffe5",e.price," - \u5e93\u5b58\uff1a",e.stock]}),r.jsx(l,{size:"mini",type:c===e.id?"primary":"default",onClick:()=>d(e.id),style:{marginTop:6},children:c===e.id?"\u5df2\u9009\u62e9":"\u9009\u62e9"})]},e.id))),c&&r.jsxs(o,{style:{marginTop:20},children:[r.jsx(i,{children:"\u8d2d\u4e70\u6570\u91cf\uff1a"}),r.jsx(a,{type:"number",value:u,onInput:e=>p(e.detail.value),style:{border:"1px solid #ccc",padding:6,width:100}}),r.jsx(l,{type:"primary",onClick:g,style:{marginLeft:10},children:"\u4e0b\u5355"})]}),m&&r.jsx(i,{style:{color:"red",marginTop:20},children:m}),h&&r.jsxs(o,{style:{marginTop:20},children:[r.jsx(i,{children:"\u8ba2\u5355\u6210\u529f\uff01"}),r.jsxs(i,{children:["\u8ba2\u5355ID\uff1a",h.orderId]}),r.jsxs(i,{children:["\u603b\u4ef7\uff1a\uffe5",h.totalPrice]})]})]})};export{j as default};
